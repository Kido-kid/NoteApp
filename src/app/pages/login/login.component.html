<div class="login-container">
  <h1 class="app-title">NoteApp</h1>

  <div class="login-box">
    <h2>Login</h2>

    <form (ngSubmit)="onLogin(loginForm)" #loginForm="ngForm" novalidate>

      <!-- USERNAME OR EMAIL -->
      <div class="input-group">
        <i class="bi bi-person input-icon"></i>
        <input
          type="text"
          name="identifier"
          placeholder="Username or Email"
          [(ngModel)]="identifier"
          #identifierCtrl="ngModel"
          #identifierInput
          (keydown.enter)="goNext(passwordInput, $event)"
          required
          autocomplete="off"
        />
      </div>
      <p class="error" *ngIf="identifierCtrl.invalid && (identifierCtrl.dirty || identifierCtrl.touched)">
        <span *ngIf="identifierCtrl.errors?.['required']">This field is required.</span>
      </p>

      <!-- PASSWORD -->
      <div class="input-group password-group">
  <i class="bi bi-lock input-icon"></i>

  <input
    [type]="showPassword ? 'text' : 'password'"
    name="password"
    placeholder="Password"
    [(ngModel)]="password"
    #passwordCtrl="ngModel"
    #passwordInput
    (keydown.enter)="onEnterPassword(loginForm)"
    required
    minlength="4"
    autocomplete="current-password"
  />

  <!-- Always render the eye; just change the icon -->
  <button
    class="eye-btn"
    type="button"
    (mousedown)="keepFocus($event)"
    (click)="togglePasswordVisibility($event)"
    aria-label="Toggle password visibility"
  >
    <i class="bi" [ngClass]="showPassword ? 'bi-eye-slash' : 'bi-eye'"></i>
  </button>
</div>

      <p class="error" *ngIf="passwordCtrl.invalid && (passwordCtrl.dirty || passwordCtrl.touched)">
        <span *ngIf="passwordCtrl.errors?.['required']">Password is required.</span>
        <span *ngIf="passwordCtrl.errors?.['minlength']">Minimum 4 characters.</span>
      </p>

      <button class="btn" type="submit" [disabled]="loginForm.invalid">
        Login
      </button>

      <p class="error center" *ngIf="loginError">
        Invalid username/email or password.
      </p>
    </form>

    <p class="signup-link">
      Donâ€™t have an account?
      <a routerLink="/signup">Create one</a>
    </p>
  </div>
</div>
